/*

	Created: 08.02.2011
	Aurthor: GhostTT
	
	Modified 23.02.2012 by ZiGGi
	
*/

#if defined _interior_included
	#endinput
#endif

#define _interior_included
#pragma library interior


enum iee_Info {
	iee_interior_ID,
	iee_icon_ID,
	Float:iee_enter_X,
	Float:iee_enter_Y,
	Float:iee_enter_Z,
	Float:iee_enter_A,
	Float:iee_exit_X,
	Float:iee_exit_Y,
	Float:iee_exit_Z,
	Float:iee_exit_A,
}

new interior_EnterExits[][iee_Info] = {
{0,-1, 1572.565429,-1334.585205, 16.484375, 203.404357,		1548.140014,-1366.420043, 326.210937, 89.999992},
{1, 45,-2492.770263,-29.114257, 25.765625, 273.712463,		203.777999,-48.492401, 1001.804687, 0.000000},
{1, 6,-2625.659912, 209.004028, 4.621434, 174.564865,		286.148986,-40.644401, 1001.515625, 359.903076},
{1, 6, 1365.461669,-1278.885253, 13.546875, 264.818267,		286.148986,-40.644401, 1001.515625, 359.903076},
{1, 45, 2112.758789,-1212.521850, 23.964426, 4.145859,		203.777999,-48.492401, 1001.804687, 0.000000},
{1, 44, 2194.699218, 1676.525878, 12.367187, 269.661773,	2233.909912, 1710.729980, 1011.298706, 180.000015},
{1, 29, 2778.586181, 2452.152587, 11.062500, 327.040191,	203.777999,-48.492401, 1001.804687, 0.000000},
{2,-1, 2421.375500, -1219.524200, 25.544100, 189.858500,	1204.812866,-12.584808, 1000.921875, 0.000000},
{3, 48,-2625.213867, 1412.120361, 7.093750, 11.995606,		-2637.449951, 1404.630004, 906.460937, 0.000000},
{3,-1, 1289.493286, 270.552703, 19.554687, 63.728549,		833.818969, 7.418000, 1004.179687, 89.999992},
{3,-1, 1631.819824,-1170.936279, 24.078125, 179.289199,		833.818969, 7.418000, 1004.179687, 89.999992},
{3,-1, 2087.108398, 2074.133300, 10.972449, 92.644783,		-100.325996,-22.816499, 1000.718750, 0.000000},
{3, 30, 2286.949462, 2431.605957, 10.820312, 0.313411,		238.662002, 141.052001, 1003.023437, 0.000000},
{3, 30, 2337.151855, 2458.534912, 14.968750, 6.662178,		288.746002, 169.350997, 1007.171875, 0.000000},
{3,-1, 2415.010009, 1123.744506, 10.820312, 90.303222,		388.872009, 173.804992, 1008.382812, 89.999992},
{3,-1, 2543.122314, 1024.685424, 10.820312, 0.442347,		1212.020019,-28.663099, 1000.953125, 180.000015},
{3, 14, 2825.254150, 2406.185302, 11.062500, 326.019500,	207.053771,-138.804290, 1003.507812, 0.000000},
{3, 45, 500.654998,-1358.671020, 16.134819, 152.065124,		207.054992,-138.804992, 1003.507812, 0.000000},
{4, 6, 2156.976074, 943.175598, 10.820312, 274.690002,		285.800994,-84.547599, 1001.515625, 359.903076},
{4, 6, 2334.037353, 61.277992, 26.484714, 88.578254,		285.800994,-84.547599, 1001.515625, 359.903076},
{4, 6, 241.160018,-178.520660, 1.578125, 271.205352,		285.800994,-84.547599, 1001.515625, 359.903076},
{4, 6, 2538.484619, 2084.107421, 10.820312, 271.450225,		285.800994,-84.547599, 1001.515625, 359.903076},
{5, 29,-1722.247192, 1358.670898, 7.187500, 284.695190,		372.351989,-131.651000, 1001.492187, 359.903076},
{5, 29,-1807.683837, 944.741699, 24.890625, 45.100429,		372.351989,-131.651000, 1001.492187, 359.903076},
{5, 29, 1366.661987, 248.687973, 19.566932, 250.453521,		372.351989,-131.651000, 1001.492187, 359.903076},
{5, 29, 203.322296,-204.691406, 1.578125, 359.855987,		372.351989,-131.651000, 1001.492187, 359.903076},
{5, 29, 2083.452636, 2223.520019, 11.023437, 5.471636,		372.351989,-131.651000, 1001.492187, 359.903076},
{5, 29, 2104.412109,-1806.434936, 13.554687, 270.530822,	372.351989,-131.651000, 1001.492187, 359.903076},
{5, 54, 2228.920410,-1722.154907, 13.562500, 326.858398,	772.111999,-3.898649, 1000.728820, 0.000000},
{5, 29, 2334.481689, 74.950744, 26.484064, 89.777725,		372.351989,-131.651000, 1001.492187, 359.903076},
{5, 29, 2351.634033, 2531.564941, 10.820312, 358.745086,	372.351989,-131.651000, 1001.492187, 359.903076},
{5, 29, 2636.339843, 1850.022705, 11.023437, 271.398345,	372.351989,-131.651000, 1001.492187, 359.903076},
{5, 29, 2801.816406, 2429.217041, 11.062500, 334.317291,	226.294006,-7.431529, 1002.210937, 89.999992},
{6, 6,-1508.892944, 2610.077636, 55.835937, 0.468554,		316.524993,-168.707000, 999.593750, 359.903076},
{6, 6,-2093.105957,-2464.149658, 30.625000, 139.218368,		296.920013,-111.071998, 1001.515625, 359.903076},
{6, 36,-2242.847900, 128.678970, 35.320312, 269.380340,		-2238.686279, 130.904876, 1035.414062, 325.000000},
{6, 54,-2269.836425,-155.953536, 35.320312, 91.706848,		774.213989,-48.924301, 1000.585937, 0.000000},
{6, 30, 1553.792114,-1674.960571, 16.195312, 267.758270,	246.783996, 63.900199, 1003.640625, 0.000000},
{6, 36, 1936.747558, 2307.243896, 10.820312, 267.168579,	-26.691600,-55.714900, 1003.546875, 0.000000},
{6, 36, 2097.755859, 2223.724609, 11.023437, 3.301678,		-26.691600,-55.714900, 1003.546875, 0.000000},
{6, 36, 2193.865722, 1991.001098, 12.296875, 269.733642,	-26.691600,-55.714900, 1003.546875, 0.000000},
{6, 36, 2247.607177, 2396.888671, 10.820312, 179.004745,	-26.691600,-55.714900, 1003.546875, 0.000000},
{6, 6, 2400.463378,-1981.036499, 13.546875, 182.964981,		296.920013,-111.071998, 1001.515625, 359.903076},
{6, 36, 2452.464111, 2064.472656, 10.820312, 359.857360,	-26.691600,-55.714900, 1003.546875, 0.000000},
{6, 30, 628.695007,-571.675598, 17.095149, 95.399177,		246.783996, 63.900199, 1003.640625, 0.000000},
{7, 54, 1968.645385, 2294.686035, 16.455863, 355.631927,	773.580017,-77.096702, 1000.655029, 0.000000},
{9, 14,-1213.174194, 1831.107910, 41.929687, 140.862716,	365.673004,-10.713199, 1001.851562, 359.903076},
{9, 14,-2154.221191,-2460.834228, 30.851562, 55.194232,		365.673004,-10.713199, 1001.851562, 359.903076},
{9, 14,-1816.5925, 617.2782, 35.1719, 183.1849,				365.673004,-10.713199, 1001.851562, 359.903076},
{9, 14,-2671.427001, 259.271942, 4.632812, 180.000015,		365.673004,-10.713199, 1001.851562, 359.903076},
{9, 14, 172.020858, 1175.125610, 14.757812, 331.377410,		365.673004,-10.713199, 1001.851562, 359.903076},
{9, 14, 2103.299316, 2228.750244, 11.023437, 85.131607,		365.673004,-10.713199, 1001.851562, 359.903076},
{9, 14, 2393.155273, 2042.108886, 10.820312, 184.443786,	365.673004,-10.713199, 1001.851562, 359.903076},
{9, 14, 2397.710449,-1898.155151, 13.546875, 186.098419,	365.674346,-10.712305, 1001.851562, 359.903076},
{9, 14, 2420.919400,-1508.942300, 24.0000, 91.494200,		365.673004,-10.713199, 1001.851562, 359.903076},
{9, 14, 2636.291503, 1671.390380, 11.023437, 268.227874,	365.673004,-10.713199, 1001.851562, 359.903076},
{9, 14, 2839.790771, 2406.077148, 11.068956, 50.758544,		365.673004,-10.713199, 1001.851562, 359.903076},
{9, 14, 927.228637,-1352.673583, 13.376535, 270.530792,		365.672454,-10.711545, 1001.851562, 359.903076},
{10, 10,-1911.244628, 829.042846, 35.171875, 140.275314,	363.414398,-74.579460, 1001.507812, 314.700012},
{10, 10,-2336.289550,-166.706802, 35.554687, 92.285903,		363.412994,-74.578697, 1001.507812, 314.700012},
{10, 10,-2357.499511, 1008.202209, 50.898437, 267.349670,	363.412994,-74.578697, 1001.507812, 314.700012},
{10, 10, 1159.049438, 2072.087402, 11.062500, 91.884552,	363.412994,-74.578697, 1001.507812, 314.700012},
{10, 10, 1199.297973,-919.651489, 43.111553, 7.905916,		363.415008,-74.579391, 1001.507812, 314.700012},
{10, 10, 1872.898803, 2071.604248, 11.062500, 74.194061,	363.412994,-74.578697, 1001.507812, 314.700012},
{10, 44, 2021.956787, 1007.176391, 10.820312, 92.351676,	2015.449951, 1017.090026, 996.875000, 89.999992},
{10, 10, 2170.567871, 2795.750732, 10.820312, 92.066276,	363.412994,-74.578697, 1001.507812, 314.700012},
{10, 10, 2366.304687, 2071.036376, 10.820312, 271.398345,	363.412994,-74.578697, 1001.507812, 314.700012},
{10, 10, 2472.204345, 2034.027954, 11.062500, 267.734130,	363.412994,-74.578697, 1001.507812, 314.700012},
{10, 5, 425.003356, 2536.359130, 16.148437, 90.054061,		420.484985, 2535.590087, 10.000000, 35.019992},
{10, 10, 813.074829,-1616.162109, 13.546875, 87.806640,		363.412994,-74.578697, 1001.507812, 314.700012},
{11, 49, 2308.654541,-1643.916015, 14.827047, 286.186004,	501.980987,-69.150199, 998.757812, 180.000015},
{11, 49, 2441.200439, 2064.611572, 10.820312, 7.533768,		501.980987,-69.150199, 998.757812, 180.000015},
{12, 44, 1659.329345, 2250.390380, 11.070102, 187.847457,	1133.069946,-9.573060, 1000.679687, 0.000000},
{15, 45,-2376.590576, 910.125427, 45.445312, 277.770935,	207.738006,-109.019996, 1005.132812, 0.000000},
{15, 45, 2103.366210, 2257.320800, 11.023437, 84.581886,	207.739395,-109.022705, 1005.132812, 0.000000},
{15,-1, 2231.978759,-1159.786865, 25.890625, 271.494171,	2216.340087,-1150.510009, 1025.796875, 270.000000},
{15, 45, 2244.633300,-1664.544677, 15.476562, 160.476791,	207.738006,-109.019996, 1005.132812, 0.000000},
{17,-1,-594.060180, 2019.842895, 60.381847, 147.771224,		-959.874023, 1952.000000, 9.000000, 217.000015},
{18, 45,-1885.251586, 863.674682, 35.172843, 312.591674,	161.391006,-95.285598, 1001.804687, 0.000000},
{18, 45, 2090.650634, 2223.554687, 11.023437, 3.852190,		161.391006,-95.285598, 1001.804687, 0.000000},
{18, 36, 2546.521240, 1971.829101, 10.820312, 356.121917,	-30.946699,-89.609596, 1003.546875, 0.000000},
{18, 36, 2886.156005, 2452.792968, 11.068956, 51.974933,	-30.946699,-89.609596, 1003.546875, 0.000000},
{7, 33, 2695.540500, -1704.540600, 11.843800, 0.000000,		-1405.987200,-261.408000, 1043.656300, 0.000000}, // стадион в гантоне
{15, 33,-2119.572800, -444.247300, 35.531300, 0.000000,		-1443.709800, 930.071700, 1036.481600, 0.000000}, // стадион во втором городе амерфут
{14, 33,-2170.891800, 252.045300, 35.335500, 0.000000,		-1464.866900, 1557.340200, 1052.531300, 0.000000}, // второй стадион во втором городе
{4, 33, 1099.600800, 1601.515700, 12.546900, 0.000000,		-1437.187000,-637.602200, 1048.876500, 0.000000}, // стадион в третьем городе
{1, 50, 1046.104500,-1130.966200, 23.828100, 0.000000,		-794.981400, 489.284700, 1376.195300, 0.000000}, // ресторан либерти сити
{1, 50, 1073.013100,-1113.377300, 24.333200, 0.000000,		-791.401500, 495.531700, 1367.367200, 0.000000}, // ресторан либерти сити доп.
{17, 48, 1835.911000, -1682.063400, 13.370000, 79.033200,	493.238200, -23.391100, 1000.679700, 6.580000} // alhambra club
};

stock interior_OnGameModeInit()
{
	DisableInteriorEnterExits();
	for (new i = 0; i < sizeof(interior_EnterExits); i++)
	{
		CreatePickup(1559, 1, interior_EnterExits[i][iee_enter_X], interior_EnterExits[i][iee_enter_Y], interior_EnterExits[i][iee_enter_Z] + 0.5,-1);
		CreatePickupText("¬ход", interior_EnterExits[i][iee_enter_X], interior_EnterExits[i][iee_enter_Y], interior_EnterExits[i][iee_enter_Z]);
		
		CreatePickup(1559, 1, interior_EnterExits[i][iee_exit_X], interior_EnterExits[i][iee_exit_Y], interior_EnterExits[i][iee_exit_Z] + 0.2,-1);
		CreatePickupText("¬ыход", interior_EnterExits[i][iee_exit_X], interior_EnterExits[i][iee_exit_Y], interior_EnterExits[i][iee_exit_Z]);
		
		if (interior_EnterExits[i][iee_icon_ID] != -1)
		{
			CreateStreamMapIcon(interior_EnterExits[i][iee_icon_ID], interior_EnterExits[i][iee_enter_X], interior_EnterExits[i][iee_enter_Y], interior_EnterExits[i][iee_enter_Z]);
		}
	}
	GameMSG("SERVER: Interior module init");
	return 1;
}

stock interior_OnPlayerKeyStateChange(playerid, newkeys, oldkeys)
{
	#pragma unused oldkeys, newkeys
	for (new i = 0; i < sizeof(interior_EnterExits); i++)
	{
		if (IsPlayerInRangeOfPoint(playerid, 2, interior_EnterExits[i][iee_exit_X], interior_EnterExits[i][iee_exit_Y], interior_EnterExits[i][iee_exit_Z]))
		{
			new id = GetPVarInt(playerid, "interior_Index");
			SetPlayerInterior(playerid, 0);
			oSetPlayerPos(playerid, interior_EnterExits[id][iee_enter_X], interior_EnterExits[id][iee_enter_Y], interior_EnterExits[id][iee_enter_Z]);
			SetPlayerFacingAngle(playerid, interior_EnterExits[id][iee_enter_A]);
			return 1;
		}
		else if (IsPlayerInRangeOfPoint(playerid, 2, interior_EnterExits[i][iee_enter_X], interior_EnterExits[i][iee_enter_Y], interior_EnterExits[i][iee_enter_Z]+0.25))
		{
			SetPVarInt(playerid, "interior_Index", i);
			SetPlayerInterior(playerid, interior_EnterExits[i][iee_interior_ID]);
			oSetPlayerPos(playerid, interior_EnterExits[i][iee_exit_X], interior_EnterExits[i][iee_exit_Y], interior_EnterExits[i][iee_exit_Z]);
			SetPlayerFacingAngle(playerid, interior_EnterExits[i][iee_exit_A]);
			return 1;
		}
	}
	return 1;
}

stock IsPlayerAtEnterExit(playerid)
{
	for (new i = 0; i < sizeof(interior_EnterExits); i++)
	{
		if (IsPlayerInRangeOfPoint(playerid, 2, interior_EnterExits[i][iee_enter_X], interior_EnterExits[i][iee_enter_Y], interior_EnterExits[i][iee_enter_Z]+0.25)
			|| IsPlayerInRangeOfPoint(playerid, 2, interior_EnterExits[i][iee_exit_X], interior_EnterExits[i][iee_exit_Y], interior_EnterExits[i][iee_exit_Z]))
		{
			return 1;
		}
	}
	return 0;
}
