/*

	About: player spawn system
	Author:	ziggi
	Thanks White_116 for W_Points (GetPointChunkPos from this lib)
*/

#if defined _pl_spawn_included
	#endinput
#endif

#define _pl_spawn_included

/*
	Defines
*/

#if !defined MAX_CELL_POINTS
	#define MAX_CELL_POINTS (50)
#elseif MAX_CELL_POINTS > 255
	#error Player spawn: MAX_CELL_POINTS should be lower than 256
#endif

#if !defined MAX_AREA_SIZE
	#define MAX_AREA_SIZE (3000)
#endif

#if !defined MAX_CELL_SIZE
	#define MAX_CELL_SIZE (60)
#endif

#define MAX_GRID_SIZE (((MAX_AREA_SIZE) * 2) / MAX_CELL_SIZE)

/*
	Vars
*/

static
	SpawnType:gPlayerSpawnType[MAX_PLAYERS];

// camera info
enum e_Spawn_Camera_Info {
	e_scInterior,
	Float:e_scPosX,
	Float:e_scPosY,
	Float:e_scPosZ,
	Float:e_scLookPosX,
	Float:e_scLookPosY,
	Float:e_scLookPosZ,
}

static gCamera[][e_Spawn_Camera_Info] = {
	{0, -2785.616943, 26.270446, 17.054141, -2775.761230, 15.552896, 12.677975},
	{0, -785.4092, 1668.5923, 67.8387,      -785.9841, 1667.7692, 67.6387},
	{0, 1937.4159, 1251.2012, 97.4819,      1938.1495, 1251.8807, 97.0875}
};

// spawn info
enum e_Spawns_Info {
	Float:e_sPosX,
	Float:e_sPosY,
	Float:e_sPosZ,
	Float:e_sAngle
}

static Float:gSpawns[][e_Spawns_Info] = {
	{2517.5344, -1694.0606, 18.4771, 47.2527},
	{2494.6113, -1694.2919, 23.5697, 7.8081},
	{2524.2092, -1675.8125, 19.9302, 65.8182},
	{2066.9448, -1700.1219, 14.1484, 276.0524},
	{2065.0754, -1732.0588, 18.7968, 308.6770},
	{2042.3876, -1722.0015, 13.5468, 339.7587},
	{2040.6574, -1646.1098, 13.5468, 1.2393},
	{1641.0234, -1545.1201, 13.5803, 293.5606},
	{1585.7886, -1539.0266, 13.5864, 265.2573},
	{1606.7871, -1476.6109, 13.5804, 0.8113},
	{1885.8452, -1087.4311, 23.9185, 279.8815},
	{2008.4741, -1098.7869, 24.9057, 256.2135},
	{2045.3112, -1158.0294, 23.4437, 145.6347},
	{2022.5230, -1210.7471, 21.7609, 35.7139},
	{1933.6676, -1226.6059, 20.1364, 97.0785},
	{1332.1098, -911.0745, 39.5780, 168.9971},
	{1309.1065, -847.0045, 64.8932, 315.8327},
	{1285.2597, -830.9578, 83.1406, 171.4035},
	{1243.5208, -743.7954, 94.9518, 191.1575},
	{655.1062, -543.5222, 16.3281, 349.4992},
	{702.5856, -463.9641, 16.3358, 189.5556},
	{852.9752, -587.0892, 18.0405, 8.3576},
	{744.7604, -582.7913, 16.9986, 84.0696},
	{248.1219, -278.0332, 1.5780, 52.9389},
	{326.3771, -53.1226, 1.5284, 111.6351},
	{214.2944, -89.7956, 1.5709, 312.5050},
	{614.6898, 43.1528, 0.0747, 344.7167},
	{867.4290, -30.7355, 63.1953, 176.7124},
	{1011.3225, 11.4863, 93.0156, 302.5120},
	{751.2595, 383.9002, 23.1718, 335.8973},
	{1222.3271, 300.4901, 19.5547, 155.6647},
	{1284.9962, 175.7557, 20.3423, 73.2173},
	{1426.9465, 371.7815, 18.8868, 257.0708},
	{1572.3760, 36.5942, 24.5907, 242.6472},
	{2215.1564, 123.8510, 26.4843, 350.1021},
	{2281.3703, -49.9920, 27.0175, 207.7729},
	{2162.9018, -102.3567, 2.7500, 27.7264},
	{2459.7744, -40.9547, 26.4843, 25.8460},
	{1958.3782, 1343.1572, 15.3746, 0.0000},
	{2199.6530, 1393.3677, 10.8203, 0.0000},
	{2483.5976, 1222.0825, 10.8203, 0.0000},
	{2637.2712, 1129.2742, 11.1796, 0.0000},
	{2000.0106, 1521.1110, 17.0625, 0.0000},
	{2024.8189, 1917.9425, 12.3386, 0.0000},
	{2261.9047, 2035.9547, 10.8203, 0.0000},
	{2262.0986, 2398.6572, 10.8203, 0.0000},
	{2244.2565, 2523.7280, 10.8203, 0.0000},
	{2335.3227, 2786.4477, 10.8203, 0.0000},
	{2150.0185, 2734.2297, 11.1763, 0.0000},
	{2158.0810, 2797.5488, 10.8203, 0.0000},
	{1969.8300, 2722.8564, 10.8203, 0.0000},
	{1652.0555, 2709.4072, 10.8264, 0.0000},
	{1564.0052, 2756.9462, 10.8203, 0.0000},
	{1271.5451, 2554.0227, 10.8203, 0.0000},
	{1441.5893, 2567.9099, 10.8203, 0.0000},
	{1480.6473, 2213.5717, 11.0234, 0.0000},
	{1400.5905, 2225.6960, 11.0234, 0.0000},
	{1598.8419, 2221.5676, 11.0625, 0.0000},
	{1318.7758, 1251.3580, 10.8203, 0.0000},
	{1558.0731, 1007.8292, 10.8125, 0.0000},
	{1705.2347, 1025.6807, 10.8203, 0.0000},
	{-6.6087, -277.3320, 5.4296, 142.8579},
	{-208.2826, -266.2718, 1.4296, 176.3615},
	{-135.8209, -355.4476, 1.4296, 192.1287},
	{-114.9721, 31.8014, 3.1171, 232.1355},
	{103.2294, 67.0710, 1.5814, 277.8826},
	{-453.3431, -64.9098, 59.6231, 65.1507},
	{-596.7870, 22.8364, 56.6584, 31.9370},
	{-724.8490, -130.0585, 68.0993, 62.9573},
	{-758.8779, 106.5894, 13.9015, 29.1171},
	{-905.4677, -489.4754, 25.9493, 346.7933},
	{-965.0922, -545.2548, 25.9609, 29.7204},
	{-1028.5052, -616.2233, 32.0078, 18.4637},
	{-1177.1857, -701.1568, 53.0433, 47.9174},
	{-875.6138, -1131.6560, 99.8175, 22.2239},
	{-1185.1087, -981.8366, 129.2187, 155.3918},
	{-1340.5434, -1026.0538, 179.8493, 61.4144},
	{-1411.3834, -961.4442, 200.2496, 11.9072},
	{-1092.9575, -1647.7343, 76.3739, 255.3696},
	{-957.6386, -1692.4112, 75.8786, 185.7857},
	{-1441.1459, -1485.0340, 101.7463, 358.7474},
	{-1859.0933, -1650.6016, 26.6371, 129.0718},
	{-1921.0333, -1761.0671, 23.6126, 53.5577},
	{-2300.5812, -1619.0345, 483.8326, 206.1525},
	{-2242.0258, -1711.0100, 480.5537, 197.6924},
	{-2556.7009, -1733.2722, 388.2573, 158.2120},
	{-2399.6376, -1339.6083, 333.3139, 318.3270},
	{-2638.1535, -1392.4960, 262.0796, 49.5078},
	{-2530.5871, -1304.0875, 270.4156, 30.6351},
	{-2573.5017, -1143.0268, 173.3809, 138.8087},
	{-2541.5502, -1883.4335, 290.5831, 258.1665},
	{-2515.5788, -1995.3393, 166.5639, 209.5993},
	{-2298.8132, -2084.5388, 117.2602, 231.2195},
	{-2106.5830, -1891.1708, 110.3207, 218.0594},
	{-2023.1677, -1968.5964, 79.9482, 35.6977},
	{-2121.8537, -2164.6010, 45.2586, 100.5583},
	{-2207.5571, -2261.5981, 30.6250, 165.3874},
	{-2060.0080, -2393.8972, 30.6250, 44.7844},
	{-2262.9616, -2430.8422, 31.5216, 225.5562},
	{-2130.0322, -2555.4890, 31.0297, 6.8710},
	{-2546.3610, -2646.7888, 37.0985, 355.9042},
	{-2603.8444, -2410.4719, 17.7172, 69.8516},
	{-2195.3735, -2773.2329, 35.6794, 325.5106},
	{-1822.0819, -2691.1870, 54.9284, 319.2440},
	{-1594.1215, -2691.4519, 48.5390, 172.3127},
	{-1467.2569, -2765.6992, 62.0760, 178.8928},
	{-1307.6070, -2820.1928, 61.9185, 205.2131},
	{-1005.4096, -2803.5229, 101.8916, 194.2464},
	{-1313.4100, -2561.0842, 35.2694, 173.2529},
	{-1614.9354, -2363.9873, 45.8301, 36.6617},
	{-1616.7164, -1942.5069, 98.4396, 20.0549},
	{-1833.1898, -2042.5687, 69.0277, 208.0333},
	{-1776.6506, -2224.9987, 68.7009, 260.9872},
	{-1300.1163, -2253.8388, 28.5525, 304.5409},
	{-974.0803, -2262.4326, 54.1457, 258.7938},
	{-910.1207, -2415.9614, 69.6695, 338.6947},
	{-771.5654, -2161.4746, 25.3956, 94.3157},
	{-886.9925, -1903.6080, 85.1374, 27.2618},
	{-974.6125, -2019.9453, 78.9639, 59.2221},
	{-660.7648, -1976.4611, 26.0324, 110.9226},
	{-480.2265, -2042.3249, 58.5660, 31.6485},
	{-498.4306, -2312.5607, 52.5236, 72.6956},
	{-429.0635, -2560.0258, 128.6290, 11.9084},
	{-302.9603, -2767.2968, 64.7376, 167.9265},
	{-97.6633, -2583.7788, 68.5333, 38.8552},
	{-222.2296, -2468.9682, 42.3010, 325.8479},
	{-721.2664, -2696.7761, 90.0050, 33.8418},
	{-1437.1749, -2431.1872, 33.0951, 200.2001},
	{-1831.5087, -2446.0300, 27.7266, 209.9135},
	{-300.3524, -1922.4245, 18.2862, 100.8959},
	{-309.2210, -1640.9798, 15.7735, 194.2467},
	{-277.5306, -1330.4468, 7.8152, 255.3239},
	{-377.7069, -1200.9893, 56.1243, 173.8565},
	{-475.7737, -1370.2015, 25.4698, 177.9299},
	{-550.7871, -1547.6719, 8.2065, 36.9285},
	{-570.6266, -1729.5611, 49.7698, 339.2747},
	{-643.2850, -1633.2426, 28.0590, 241.2728},
	{-653.9767, -1288.5599, 21.2729, 277.8373},
	{-779.9722, -1358.5616, 82.3324, 277.8373},
	{-791.2327, -1585.1536, 126.2709, 219.8700},
	{-976.2272, -1316.9503, 138.9043, 102.7056},
	{-1255.0008, -1300.2996, 142.3436, 205.1432},
	{-288.2478, -939.5281, 42.5041, 289.1172},
	{-404.9303, -747.0819, 30.3673, 264.6771},
	{-508.0043, -502.5872, 25.5234, 213.3134},
	{-691.6337, -488.5925, 35.2088, 50.3785},
	{-772.8031, -696.6585, 110.9385, 293.8174},
	{-842.2899, -808.3742, 149.6319, 308.2309},
	{-926.7479, -947.7724, 131.5534, 68.5521},
	{-1046.0551, -847.6756, 134.2600, 133.4127},
	{-1107.4403, -1174.9647, 129.2187, 130.5927},
	{-67.3396, -757.0970, 9.7538, 253.1072},
	{-37.4373, -490.3986, 3.3897, 298.5410},
	{106.9346, -719.6600, 29.5340, 353.3848},
	{303.1260, -814.9381, 3.4936, 237.9468},
	{401.1069, -464.9299, 28.3249, 237.9468},
	{472.6648, -313.2364, 36.1270, 213.0002},
	{526.4110, -590.5617, 26.1066, 171.0367},
	{558.9342, -956.8353, 88.6076, 48.5458},
	{344.2229, -1050.2556, 94.9683, 3.4254},
	{177.0545, -1233.2403, 78.3750, 197.3572},
	{230.8264, -1324.8074, 53.7235, 275.0646},
	{184.8205, -1448.0140, 12.9221, 213.9640},
	{171.3400, -1673.4664, 15.2582, 223.0508},
	{268.4377, -1715.0291, 6.8370, 249.3710},
	{537.2088, -1784.4389, 5.8682, 281.0179},
	{257.7256, -1826.0001, 3.8834, 336.7918},
	{653.9188, -1855.1527, 5.4609, 329.2717},
	{648.4415, -1780.3063, 12.2917, 335.5383},
	{781.1482, -1820.3234, 13.0234, 339.2984},
	{895.3362, -1861.3460, 8.9826, 286.6579},
	{966.9827, -1833.5893, 12.6000, 255.9510},
	{938.1719, -1660.6695, 13.5433, 144.0899},
	{1111.1602, -1748.0056, 13.5703, 267.8578},
	{1166.4350, -1922.0971, 38.6859, 281.0179},
	{1166.7620, -1880.0336, 13.5469, 281.0179},
	{1073.0718, -1886.0704, 13.5468, 41.3390},
	{1158.4177, -2305.7312, 24.7352, 216.4706},
	{1200.5433, -2376.2233, 11.1145, 155.0567},
	{1298.4042, -2432.5234, 8.9453, 155.0567},
	{1494.3448, -2095.7719, 29.7074, 181.0636},
	{1620.6683, -1928.0251, 26.6627, 263.4711},
	{1476.2161, -1676.8480, 14.0468, 64.7667},
	{1128.7746, -1488.0363, 22.7690, 185.7848},
	{877.6748, -1527.7535, 13.5546, 180.7715},
	{1003.3378, -1443.7281, 13.5468, 95.2541},
	{1005.9287, -1359.8210, 13.3276, 332.1364},
	{899.4276, -1233.0219, 16.6806, 350.2129},
	{732.9412, -1203.8238, 18.6731, 67.1567},
	{406.3580, -1538.9282, 32.2734, 310.8529},
	{280.1097, -1555.2368, 35.4986, 183.9281},
	{337.0901, -1659.2479, 33.5486, 254.4289},
	{491.5174, -1679.4674, 20.8175, 334.0163},
	{696.4951, -1512.2038, 15.1431, 45.7702},
	{697.2002, -1440.5823, 13.5390, 323.0494},
	{612.0733, -1051.5416, 62.9084, 323.4353},
	{430.8651, -1110.6080, 79.9680, 199.2816},
	{445.4361, -988.3161, 81.0357, 236.2552},
	{400.3589, -785.3081, 24.2646, 26.9700},
	{568.9541, -742.3629, 21.1997, 293.5957},
	{720.5157, -741.4824, 24.6645, 80.5505},
	{776.6566, -471.2020, 16.3359, 123.4775},
	{1111.9639, -202.7044, 44.6545, 12.8698},
	{1007.2266, -334.6921, 73.9854, 270.7222},
	{791.4508, -320.5137, 17.8349, 33.5500},
	{637.5513, -320.4851, 15.4121, 333.3894},
	{641.2286, -99.7981, 19.4907, 187.3982},
	{431.9378, 96.3726, 9.0150, 1.6132},
	{475.4650, 249.8868, 11.3720, 237.8454},
	{979.9567, 250.1901, 31.2283, 11.9533},
	{1092.3726, 409.6154, 29.3103, 349.7064},
	{1280.2276, 468.3387, 19.1446, 322.1329},
	{1532.8007, 184.5680, 24.1260, 16.9667},
	{1406.7080, 72.8654, 27.8989, 16.9667},
	{1405.8745, -194.1093, 10.2008, 160.7881},
	{1448.3941, -406.5722, 43.2876, 195.8818},
	{1511.5843, -529.0421, 63.2331, 341.2698},
	{1503.7935, -747.8338, 89.1938, 133.8412},
	{1628.6467, -769.5120, 60.5831, 296.7526},
	{1823.2434, -811.6416, 74.2131, 99.3507},
	{1864.5241, -952.1252, 51.6021, 135.6977},
	{1723.4606, -1107.5083, 24.0781, 258.5256},
	{1820.3614, -1122.8298, 24.0781, 110.9442},
	{1737.1500, -1276.2623, 13.5488, 250.9821},
	{1775.8192, -1359.7784, 15.7578, 276.3623},
	{1543.2087, -1276.7645, 17.4061, 163.8745},
	{1565.4373, -1321.8028, 16.4843, 267.5888},
	{1259.1220, -1239.0521, 17.6668, 241.2685},
	{1103.3726, -1214.5877, 17.8046, 147.2676},
	{1117.0244, -1320.4906, 13.7589, 264.4320},
	{1021.9008, -1095.1209, 23.8348, 276.3388},
	{1122.4632, -1004.9714, 29.8631, 180.4580},
	{1794.8046, -1434.3044, 13.4160, 180.4580},
	{1760.1290, -1543.2325, 9.3679, 221.8183},
	{1896.4863, -1561.9755, 13.6305, 294.8253},
	{1965.0578, -1596.1926, 13.5659, 109.6201},
	{1903.2271, -1801.6140, 13.5468, 273.4716},
	{1878.8930, -1856.6268, 13.5768, 297.2851},
	{1779.5954, -2052.9499, 13.5773, 328.3054},
	{1894.1508, -2101.5263, 13.5609, 71.0797},
	{1838.9810, -2132.0429, 15.1729, 16.5592},
	{1703.4635, -2151.2485, 13.5565, 228.3511},
	{1521.7358, -2166.1059, 13.5468, 241.8246},
	{1920.5286, -2378.7565, 13.5468, 148.4504},
	{1751.1522, -2531.9934, 13.5468, 48.4961},
	{2003.5157, -2548.1877, 13.5468, 214.5644},
	{1457.6446, -2534.3862, 13.5468, 212.9977},
	{1411.1207, -2736.7839, 7.6724, 323.2687},
	{2249.7736, -2551.6437, 8.3046, 178.8206},
	{2379.7138, -2568.5842, 13.6640, 186.6539},
	{2450.7929, -2501.4704, 13.6724, 196.3674},
	{2520.6188, -2461.1506, 13.6273, 143.7268},
	{2748.4060, -2440.4841, 13.6431, 333.9219},
	{2795.9526, -2169.2241, 12.6760, 327.6552},
	{2888.9577, -1971.9996, 5.3785, 23.7423},
	{2866.5830, -1836.1198, 11.0334, 13.0888},
	{2301.2990, -1837.6129, -0.0758, 209.5272},
	{2351.5834, -1894.7507, 13.5468, 316.0616},
	{2328.3925, -2086.1721, 13.5468, 75.3888},
	{2143.1374, -2061.4851, 13.5543, 234.9076},
	{2171.5727, -2300.1223, 13.5468, 191.6671},
	{2067.2524, -2220.0058, 13.5468, 190.7272},
	{2119.5759, -2146.9321, 13.6085, 176.6271},
	{2007.2821, -2049.7521, 13.5468, 157.8268},
	{2021.3541, -1868.0811, 13.5468, 205.7673},
	{2332.3447, -1803.6273, 13.5468, 357.4455},
	{2255.1423, -1785.6644, 13.5468, 297.9116},
	{2300.5007, -1694.6397, 13.4584, 262.5045},
	{2396.0471, -1694.9277, 13.5837, 105.2097},
	{2578.8032, -1683.8415, 1.6406, 181.0368},
	{2572.7805, -1893.8485, 3.8288, 181.0368},
	{2572.7812, -2006.1217, 3.8593, 180.4097},
	{2584.4086, -2089.3718, 2.5400, 291.3315},
	{2648.5788, -2199.0959, 13.5468, 7.7855},
	{2491.9265, -2200.2065, 13.6059, 106.4864},
	{2276.1064, -2324.4431, 13.5468, 272.8446},
	{2175.9960, -2640.8757, 13.5468, 232.4242},
	{2656.5278, -1907.3780, 12.8794, 302.6115},
	{2580.4294, -1804.4458, 1.6406, 349.6119},
	{2447.3105, -1829.1330, 9.2660, 90.1928},
	{2317.0878, -1998.3266, 13.5508, 347.7319},
	{2130.5822, -1823.2921, 13.5592, 1.2054},
	{2117.8115, -1930.0620, 13.5468, 353.9987},
	{2177.7968, -1980.7116, 13.5518, 270.9646},
	{1569.3013, -2350.4799, 13.5546, 335.5119},
	{1736.9366, -2240.8464, 13.5415, 125.8899},
	{1575.0825, -2229.1003, 13.5526, 230.8341},
	{1379.2163, -2229.7082, 13.5468, 148.4266},
	{1236.2758, -2109.1372, 58.9261, 321.9916},
	{1363.1757, -2007.6511, 49.6321, 320.1115},
	{1464.5693, -1952.8206, 26.6371, 249.9242},
	{1576.3226, -2001.9367, 32.9877, 55.9924},
	{1763.8720, -1923.6971, 13.5695, 357.7119},
	{1785.0074, -1813.3516, 13.5578, 253.9711},
	{1640.7324, -1753.0301, 13.5468, 261.5176},
	{1376.6163, -1908.1140, 17.9263, 280.2943},
	{1263.8542, -1797.7744, 13.4136, 300.0344},
	{1595.9703, -1026.6392, 23.9062, 195.0667},
	{1515.1824, -896.7744, 54.8151, 228.5703},
	{2102.5004, -957.7869, 54.0940, 183.7632},
	{2228.5937, -985.1424, 62.1599, 191.5966},
	{2297.8786, -1014.9377, 59.9273, 151.8029},
	{2383.2133, -1002.6698, 62.3874, 227.0036},
	{2481.4345, -989.1150, 70.2389, 170.9164},
	{2568.4335, -992.6920, 80.2691, 227.6304},
	{2639.6831, -1007.0418, 84.5950, 194.7300},
	{2784.9047, -1006.3128, 53.1856, 240.7905},
	{2631.2141, -896.8577, 74.7698, 211.6736},
	{2354.2553, -871.0704, 114.2611, 233.6071},
	{2176.5791, -875.2315, 87.9733, 178.1468},
	{1990.4951, -876.1392, 115.2937, 84.4590},
	{1988.9107, -721.5653, 123.8057, 71.2989},
	{1864.6329, -606.7037, 66.5223, 315.3645},
	{1906.8886, -424.6227, 21.4034, 333.2246},
	{1988.6811, -352.0507, 26.5197, 44.3520},
	{2198.8271, -446.3174, 110.7085, 347.6381},
	{2381.0290, -502.5893, 118.1764, 232.3303},
	{2339.5024, -642.5656, 129.2098, 253.9505},
	{2465.4851, -683.8496, 117.8938, 215.7235},
	{2465.6801, -851.8077, 102.5395, 247.3704},
	{2703.7329, -641.7492, 81.0672, 280.5841},
	{2619.7805, -474.3940, 74.4743, 335.7313},
	{2551.4816, -338.5947, 64.3439, 207.6001},
	{2336.3049, -368.3707, 59.3750, 201.9601},
	{2136.8051, -686.8828, 64.6939, 17.4285},
	{2790.8659, -871.5624, 27.0424, 281.8609},
	{2816.6975, -590.9523, 18.5861, 12.1018},
	{2900.1284, -492.0213, 10.2087, 39.6754},
	{2760.1403, -307.9251, 18.7350, 358.3153},
	{2609.0747, -139.8499, 46.2819, 265.8809},
	{2455.2587, -167.7206, 30.5473, 213.5538},
	{2329.4667, -194.2993, 18.4783, 11.1619},
	{2411.6352, 134.9280, 26.4371, 80.7226},
	{2298.7331, 260.5046, 22.2626, 118.0096},
	{2537.2707, 330.0796, 26.3430, 211.9871},
	{2664.0678, 231.4154, 56.1207, 267.4476},
	{2638.4392, 128.0854, 36.8813, 178.7737},
	{2694.6013, -26.2087, 37.0172, 254.9143},
	{2800.9494, -91.4730, 39.9004, 150.5733},
	{2829.0056, -245.4560, 11.2008, 119.2397},
	{2047.2208, 383.2979, 21.6512, 148.6933},
	{1864.6954, 396.7777, 19.0417, 133.6532},
	{1780.0037, 340.5813, 18.9470, 80.3860},
	{1792.4478, 145.1342, 33.3848, 94.4861},
	{1946.3514, 102.6466, 29.9141, 192.5604},
	{1913.7705, 0.0102, 33.3443, 107.6462},
	{1702.8173, 43.1352, 30.4923, 33.3855},
	{1716.3846, -110.4536, 42.7061, 62.8392},
	{1742.4804, -247.7795, 81.2460, 37.7723},
	{1766.8295, -418.7077, 80.3913, 133.3399},
	{1780.4443, -517.0190, 69.3306, 122.3731},
	{1567.5373, -339.6263, 18.3375, 5.0774},
	{1167.2006, -373.1558, 58.2068, 265.5444},
	{1187.7884, -18.7806, 45.9831, 276.8244},
	{718.6055, 123.2277, 38.3366, 41.8456},
	{634.6451, 263.3358, 21.2742, 22.7321},
	{282.1606, 107.6398, 4.0934, 178.7502},
	{1438.4753, 278.3195, 19.4622, 81.3026},
	{1550.4046, 321.1682, 18.8365, 346.0484},
	{2035.7363, 229.7144, 25.9059, 106.0561},
	{2466.1040, 264.0847, 33.2676, 57.4890},
	{2089.4238, -496.5120, 90.6150, 64.0691},
	{926.1674, 134.0945, 50.5280, 343.5418},
	{969.2501, 468.8725, 17.5433, 205.9871},
	{1124.2954, 517.8947, 19.9921, 293.8897},
	{-391.8468, 211.8220, 7.1273, 73.1559},
	{-531.5642, 142.4097, 19.3757, 350.1218},
	{-588.1922, 268.3801, 4.0773, 71.5892},
	{-840.3273, -179.0675, 66.4536, 12.0553},
	{-836.2904, -403.7331, 16.3234, 218.2072},
	{-1060.0759, -446.0050, 34.8300, 218.2072},
	{-1644.8619, -849.4093, 95.7287, 10.1518},
	{-1684.9240, -1030.6030, 72.7369, 69.3724},
	{-1528.0732, -1238.9943, 101.2908, 54.0189},
	{-1615.8488, -1280.5426, 57.7360, 89.7392},
	{-1547.6949, -1379.3782, 50.3153, 113.2395},
	{-1689.6983, -1155.1560, 73.0218, 55.5856},
	{-1826.7235, -1085.4995, 56.3599, 202.5403},
	{-1607.0096, -1565.2575, 35.4595, 201.2870},
	{-1830.5678, -1322.5026, 31.2318, 26.7821},
	{-1927.3781, -1093.2081, 33.5773, 355.1351},
	{-2019.1962, -967.0648, 32.1718, 357.6418},
	{-2228.6555, -827.3804, 55.2217, 237.3206},
	{-2786.1674, -842.9353, 25.7303, 112.6127},
	{-2854.6845, -1200.1798, 25.5106, 62.7923},
	{-2862.7160, -1484.4576, 136.2385, 41.7987},
	{-2818.9365, -1694.2301, 141.5630, 83.1591},
	{-2721.5583, -1964.6785, 49.7847, 114.4928},
	{-2621.4692, -1588.4339, 332.0660, 133.9196},
	{-2488.8427, -1646.5877, 427.7588, 133.6063},
	{-2370.3264, -1861.5957, 412.8162, 311.2447},
	{-2227.8642, -1860.5502, 230.7922, 284.9244},
	{-2041.5825, -1567.5010, 135.3566, 273.3310},
	{-2373.7460, -1162.5192, 176.3601, 43.1756},
	{-2695.4384, -1718.8953, 252.8318, 234.1874},
	{-2372.0947, -1581.1022, 498.8418, 199.4072},
	{-2356.4511, -1770.4709, 464.1235, 160.8669},
	{-2396.6345, -2190.6457, 33.2890, 295.8915},
	{-2375.6237, -2403.3002, 24.8619, 155.5168},
	{-2307.8481, -2525.1516, 27.4094, 199.0706},
	{-2684.7021, -2582.6879, 9.6794, 255.1578},
	{-2558.4589, -2806.2145, 3.2010, 349.1587},
	{-2740.1867, -2316.1347, 6.7317, 286.8048},
	{-1967.5598, -2755.6447, 47.2789, 6.3921},
	{-2087.9858, -2724.7358, 63.9412, 166.6999},
	{-1955.8957, -2230.2751, 65.4791, 220.0876},
	{-1521.9576, -2575.1035, 62.1310, 159.3003},
	{-1261.8997, -2629.7619, 7.6155, 102.6099},
	{-981.8513, -2621.0378, 89.1529, 294.0349},
	{-745.1442, -2465.7553, 70.2905, 54.0427},
	{-625.5724, -2531.7097, 62.6674, 63.7561},
	{-472.8735, -2447.1142, 112.9481, 310.0150},
	{-121.4281, -2773.5419, 63.6190, 138.9568},
	{47.7184, -2648.6289, 40.4629, 25.2158},
	{-2.9723, -2496.9294, 36.6554, 119.8278},
	{-344.5301, -2258.7216, 41.2681, 301.2416},
	{-590.5081, -2211.1154, 28.5237, 65.9260},
	{-943.4553, -2513.4003, 110.1036, 226.9809},
	{-1067.9663, -2346.7011, 52.6105, 136.1132},
	{-1055.4390, -1951.8854, 65.9331, 3.9087},
	{-800.7074, -1735.3452, 88.1373, 251.4210},
	{-601.8846, -1452.2185, 12.1481, 164.9169},
	{-394.2314, -1495.4036, 24.8870, 38.9557},
	{-198.2322, -1200.5437, 7.9912, 327.2017},
	{-31.5807, -1171.6107, 4.2320, 80.3162},
	{-31.9088, -1255.5552, 7.7140, 80.3162},
	{6.7272, -962.4462, 20.2225, 100.0564},
	{8.8668, -822.3760, 13.7683, 84.3896},
	{-597.2581, -606.3445, 23.2399, 84.3896},
	{-793.9041, -520.2094, 32.7182, 11.0689},
	{-1420.2019, -793.1406, 83.9998, 274.5847},
	{-1284.8675, -752.1865, 68.0367, 330.0452},
	{-934.0139, -695.0908, 49.0117, 17.3589},
	{-573.8892, -424.9466, 31.6524, 102.2731},
	{-351.8323, -382.9830, 6.4732, 141.7534},
	{-207.5750, -30.1437, 3.1171, 216.3275},
	{16.5231, -114.0324, 0.6093, 205.9874},
	{72.6206, -156.5279, 1.3409, 162.1203},
	{145.3591, -355.4255, 2.9504, 262.3880},
	{216.5124, -538.9882, 52.6629, 214.4475},
	{243.6577, -685.9979, 23.9740, 10.1522},
	{382.7741, -922.2351, 25.2040, 34.5925},
	{456.4768, -82.6598, 21.0708, 131.7268},
	{527.1887, 324.0072, 13.2828, 266.4613},
	{1102.8471, 315.4917, 21.7863, 222.8841},
	{1326.6947, -107.0070, 30.6861, 89.0895},
	{1914.7233, 236.9480, 29.0522, 351.3286},
	{2570.2211, -21.4939, 27.7522, 88.4629},
	{2550.6508, 172.9777, 38.4406, 142.0434},
	{2678.4919, -544.3994, 70.8448, 280.2012},
	{2584.8828, -618.2770, 131.0246, 322.1883},
	{2766.7805, -1189.3843, 69.4085, 2.2951},
	{2753.8386, -1112.4764, 69.5781, 27.3620},
	{2569.4499, -1110.5742, 65.5685, 58.6956},
	{2490.4235, -1118.7817, 50.5666, 329.0815},
	{2375.3208, -1118.8640, 28.9637, 319.9947},
	{2297.9990, -1108.2388, 37.0903, 236.9606},
	{2211.0268, -1262.6298, 23.8846, 77.4724},
	{2126.4260, -1262.4968, 23.9921, 77.4724},
	{2215.5781, -1345.3216, 23.9844, 234.4541},
	{2112.4846, -1351.4124, 23.9843, 10.0033},
	{2169.4711, -1457.9616, 23.9843, 352.7698},
	{2240.0402, -1521.0421, 25.8658, 347.7330},
	{2508.6328, -1544.3664, 23.5022, 6.2433},
	{2601.6169, -1488.1625, 16.4867, 209.5750},
	{2605.9282, -1401.1911, 35.5595, 5.9064},
	{2540.4582, -1328.9687, 34.6656, 323.2926},
	{2472.8884, -1370.9129, 28.8339, 263.7588},
	{2410.0905, -1314.4168, 24.6632, 279.1123},
	{2335.0146, -1226.8999, 27.9765, 77.6605},
	{2337.3117, -1352.5153, 24.2952, 286.4628},
	{2353.3652, -1900.0882, 13.5468, 140.3276},
	{2476.5124, -2089.0173, 13.5468, 98.0273},
	{2503.5124, -1978.9531, 13.4569, 99.2807},
	{2445.1232, -1883.2191, 13.5533, 92.0739},
	{2666.5214, -2019.9167, 13.5526, 330.8128},
	{2450.9873, -1977.5025, 13.5539, 255.2987},
	{2018.1380, -1977.9812, 13.5468, 273.7856},
	{2085.6416, -1991.9281, 13.5468, 79.2037},
	{1906.0430, -1989.9176, 13.5468, 316.0626},
	{1488.2702, -1844.1601, 13.5468, 290.0556},
	{1363.0869, -1648.3210, 13.3828, 255.2753},
	{1774.9213, -1666.8870, 14.4279, 52.2334},
	{2630.7084, -2128.1804, 13.5468, 169.4212},
	{2783.8496, -2026.7609, 13.5619, 345.8062},
	{2784.2216, -1687.4467, 9.8507, 63.8503},
	{2236.6357, -1625.4721, 15.6448, 154.0677},
	{2305.5170, -1443.7648, 24.0000, 37.1933},
	{1935.9840, -1372.0178, 17.0721, 80.1203},
	{1647.9739, -1342.4652, 17.4359, 74.1669},
	{1259.0588, -1486.1097, 13.5468, 263.4222},
	{811.2598, -1541.6529, 13.5505, 60.6935},
	{733.3408, -1297.9616, 13.5709, 274.3655},
	{208.1042, -1565.7036, 28.8565, 318.8592},
	{976.6459, -1978.6791, 1.7957, 247.7319},
	{1972.5031, -1674.6702, 15.9687, 269.9553},
	{2329.3254, -1258.5993, 27.9765, 257.1085},
	{2221.3793, -1160.0617, 25.7330, 343.5893},
	{2114.2644, -1046.8709, 27.0268, 231.1014},
	{1961.3963, -991.8507, 39.9359, 235.4881},
	{997.1918, -910.8767, 42.1796, 149.9472},
	{886.0310, -911.1121, 47.4676, 203.2144},
	{760.2052, -980.5827, 48.3166, 190.6810},
	{706.0309, -917.5011, 78.5234, 160.3108},
	{826.4044, -822.8933, 81.0188, 102.0471},
	{1080.4466, -718.2492, 109.2039, 167.1808},
	{1217.5935, -677.1519, 84.1355, 43.7263},
	{1379.4122, -742.4025, 98.2733, 306.9288},
	{1575.8489, -841.2291, 61.4601, 208.8544},
	{1756.7978, -729.6052, 56.4444, 81.6399},
	{1827.2496, -893.5372, 58.4806, 127.0737},
	{1322.7325, -391.4764, 9.4220, 50.3296},
	{1112.7060, -502.2640, 56.1909, 327.9221},
	{990.6481, -593.3927, 111.5699, 191.6207},
	{530.5271, -845.6979, 90.3041, 292.1783},
	{475.0221, -540.6752, 40.5974, 187.8372},
	{548.7849, -454.9942, 39.6530, 314.4251},
	{1121.8585, -580.8481, 104.9098, 169.0605},
	{1452.9537, -589.4883, 88.9463, 10.8491},
	{1655.1970, -653.1270, 57.2603, 205.4609},
	{2109.3803, -847.8393, 100.9943, 335.4654},
	{2681.5024, -1329.5234, 42.8671, 85.4464},
	{2782.6948, -1406.3898, 24.7453, 0.2422},
	{2785.0517, -1561.6024, 17.7722, 252.4546},
	{2062.7915, -1572.1005, 13.4452, 271.2547},
	{2002.0792, -1388.4106, 19.6566, 1.7855},
	{1872.5791, -1407.3940, 13.5703, 23.7190},
	{1523.5970, -1205.6293, 23.6190, 293.7915},
	{1547.6502, -1112.6733, 24.0781, 87.6397},
	{1222.4595, -1612.9696, 13.5468, 259.6379},
	{1182.4245, -1659.7944, 13.8478, 198.5373},
	{1076.4472, -1664.7222, 13.7842, 269.6413},
	{865.5487, -1719.3656, 13.5468, 172.1937},
	{581.1124, -1487.9899, 15.2319, 8.6321},
	{586.3845, -1294.7470, 15.1863, 289.6714},
	{861.6682, -1102.2421, 24.2968, 271.4980},
	{1217.0377, -1001.3464, 33.2014, 284.6580}
};

// chunks
static
	gChunkPoints[MAX_GRID_SIZE][MAX_GRID_SIZE][MAX_CELL_POINTS],
	gChunkPointsCount[MAX_GRID_SIZE][MAX_GRID_SIZE char];

/*
	OnGameModeInit
*/

public OnGameModeInit()
{
	new
		i,
		chunk_x,
		chunk_y,
		chunk_pointid;

	while (i < sizeof(gSpawns)) {
		GetPointChunkPos(gSpawns[i][e_sPosX], gSpawns[i][e_sPosY], chunk_x, chunk_y);

		chunk_pointid = gChunkPointsCount[chunk_x]{chunk_y};
		if (chunk_pointid >= MAX_CELL_POINTS) {
			Log(systemlog, DEBUG, "Error <player_spawn:OnGameModeInit>: points in one cell is too much (point %d).", i);
			break;
		}

		gChunkPoints[chunk_x][chunk_y][chunk_pointid] = i;

		gChunkPointsCount[chunk_x]{chunk_y}++;
		i++;
	}

	#if defined PSpawn_OnGameModeInit
		return PSpawn_OnGameModeInit();
	#else
		return 1;
	#endif
}
#if defined _ALS_OnGameModeInit
	#undef OnGameModeInit
#else
	#define _ALS_OnGameModeInit
#endif

#define OnGameModeInit PSpawn_OnGameModeInit
#if defined PSpawn_OnGameModeInit
	forward PSpawn_OnGameModeInit();
#endif

/*
	OnPlayerRequestClass
*/

public OnPlayerRequestClass(playerid, classid)
{
	if (IsPlayerLogin(playerid)) {
		SpawnPlayer(playerid);
		return 0;
	}

	// clear chat
	Chat_Clear(playerid);

	// hide class selection buttons
	TogglePlayerSpectating(playerid, 1);

	// set camera pos
	new camera_id = random( sizeof(gCamera) );
	SetPlayerInterior(playerid, gCamera[camera_id][e_scInterior]);
	SetPlayerCameraPos(playerid, gCamera[camera_id][e_scPosX], gCamera[camera_id][e_scPosY], gCamera[camera_id][e_scPosZ]);
	SetPlayerCameraLookAt(playerid, gCamera[camera_id][e_scLookPosX], gCamera[camera_id][e_scLookPosY], gCamera[camera_id][e_scLookPosZ]);

	#if defined PSpawn_OnPlayerRequestClass
		return PSpawn_OnPlayerRequestClass(playerid, classid);
	#else
		return 1;
	#endif
}
#if defined _ALS_OnPlayerRequestClass
	#undef OnPlayerRequestClass
#else
	#define _ALS_OnPlayerRequestClass
#endif

#define OnPlayerRequestClass PSpawn_OnPlayerRequestClass
#if defined PSpawn_OnPlayerRequestClass
	forward PSpawn_OnPlayerRequestClass(playerid, classid);
#endif

/*
	Functions
*/

DialogCreate:PlayerSpawnMenu(playerid)
{
	new
		string[ MAX_NAME * (MAX_PLAYER_HOUSES + 2) ],
		count = 0,
		playername[MAX_PLAYER_NAME + 1];

	GetPlayerName(playerid, playername, sizeof(playername));

	Lang_GetPlayerText(playerid, "PLAYER_SPAWN_LIST_NEARLY_POINT", string);

	new gangid = GetPlayerGangID(playerid);
	new gang_houseid = -1;

	if (gangid != INVALID_GANG_ID) {
		gang_houseid = Gang_GetHouseID(gangid);
		if (gang_houseid != -1) {
			count++;
			Lang_GetPlayerText(playerid, "PLAYER_SPAWN_LIST_GANG", string, _, house_GetName(gang_houseid));
		}
	}

	for (new i = 0; i < house_GetCount(); i++) {
		if (gang_houseid != i && (!strcmp(house_GetOwner(i), playername, true) || !strcmp(house_GetRenter(i), playername, true))) {
			count++;
			strcat(string, house_GetName(i), sizeof(string));
			strcat(string, "\n", sizeof(string));
		}
	}

	if (count < 1) {
		Dialog_MessageEx(playerid, Dialog:PlayerReturnMenu,
		                 "PLAYER_SPAWN_DIALOG_HEADER",
		                 "PLAYER_SPAWN_DIALOG_INFO",
		                 "PLAYER_SPAWN_DIALOG_BUTTON_BACK", "PLAYER_SPAWN_DIALOG_BUTTON_BACK");
		return 1;
	}

	Dialog_Open(playerid, Dialog:PlayerSpawnMenu, DIALOG_STYLE_LIST,
	            "PLAYER_SPAWN_DIALOG_HEADER",
	            string,
	            "PLAYER_SPAWN_DIALOG_BUTTON_OK", "PLAYER_SPAWN_DIALOG_BUTTON_BACK",
	            MDIALOG_NOTVAR_INFO);
	return 1;
}

DialogResponse:PlayerSpawnMenu(playerid, response, listitem, inputtext[])
{
	if (!response) {
		Dialog_Show(playerid, Dialog:PlayerMenu);
		return 1;
	}

	new playername[MAX_PLAYER_NAME + 1];
	GetPlayerName(playerid, playername, sizeof(playername));

	if (listitem == 0) {
		SetPlayerSpawnType(playerid, SPAWN_TYPE_NONE);
		Dialog_Message(playerid,
		               "PLAYER_SPAWN_DIALOG_HEADER",
		               "PLAYER_SPAWN_HAS_CHANGED",
		               "PLAYER_SPAWN_DIALOG_BUTTON_OK");
		return 1;
	}

	new gangid = GetPlayerGangID(playerid);
	if (listitem == 1 && gangid != INVALID_GANG_ID && Gang_GetHouseID(gangid) != -1) {
		SetPlayerSpawnType(playerid, SPAWN_TYPE_GANG);
		Dialog_Message(playerid,
		               "PLAYER_SPAWN_DIALOG_HEADER",
		               "PLAYER_SPAWN_HAS_CHANGED",
		               "PLAYER_SPAWN_DIALOG_BUTTON_OK");
		return 1;
	}

	new count = 1;
	if (gangid != INVALID_GANG_ID && Gang_GetHouseID(gangid) != -1) {
		count++;
	}

	for (new i = 0; i < house_GetCount(); i++) {
		if (Gang_GetHouseID(gangid) == i || strcmp(house_GetOwner(i), playername, true) && strcmp(house_GetRenter(i), playername, true)) {
			continue;
		}

		if (listitem == count) {
			SetPlayerSpawnType(playerid, SPAWN_TYPE_HOUSE);
			SetPlayerSpawnHouseID(playerid, i);

			// если игрок, сменивший спавн - лидер банды, то устанавливаем домом банды этот дом
			if (GangMember_IsPlayerHaveRank(playerid, GangMemberLeader)) {
				Gang_SetHouseID(gangid, i);
				Dialog_Message(playerid,
				               "PLAYER_SPAWN_DIALOG_HEADER",
				               "PLAYER_SPAWN_GANG_HAS_CHANGED",
				               "PLAYER_SPAWN_DIALOG_BUTTON_OK");
			} else {
				Dialog_Message(playerid,
				               "PLAYER_SPAWN_DIALOG_HEADER",
				               "PLAYER_SPAWN_HAS_CHANGED",
				               "PLAYER_SPAWN_DIALOG_BUTTON_OK");
			}
			return 1;
		}

		count++;
	}
	return 1;
}

stock GetPlayerSpawnPos(playerid, &Float:spos_x = 0.0, &Float:spos_y = 0.0, &Float:spos_z = 0.0, &Float:spos_a = 0.0, &interior = 0, &world = 0)
{
	GetPlayerSpawnCoords(playerid, spos_x, spos_y, spos_z, spos_a, interior, world);

	if (spos_x != 0.0 && spos_y != 0.0 && spos_z != 0.0) {
		return 1;
	}

	if (IsPlayerJailed(playerid)) {
		GetJailPos(spos_x, spos_y, spos_z, spos_a, interior);
		return 1;
	}

	if (Spectate_IsAfterSpec(playerid)) {
		Spectate_GetPlayerPos(playerid, spos_x, spos_y, spos_z, spos_a, interior, world);
		return 1;
	}

	new SpawnType:spawn_type = GetPlayerSpawnType(playerid);

	if (spawn_type == SPAWN_TYPE_HOUSE) {
		new house_id = GetPlayerSpawnHouseID(playerid);
		if (house_id >= 0 && !IsPlayerHouse(playerid, house_id) && !IsPlayerRenter(playerid, house_id)) {
			SetPlayerSpawnType(playerid, SPAWN_TYPE_NONE);
			SetPlayerSpawnHouseID(playerid, -1);
			Lang_SendText(playerid, "HOUSING_KICKED");
		} else {
			house_GetPickupPos(house_id, spos_x, spos_y, spos_z);
		}
	} else if (spawn_type == SPAWN_TYPE_GANG) {
		new
			gangid,
			gang_houseid;

		gangid = GetPlayerGangID(playerid);
		gang_houseid = Gang_GetHouseID(gangid);

		if (gangid == INVALID_GANG_ID || gang_houseid == -1) {
			SetPlayerSpawnType(playerid, SPAWN_TYPE_NONE);
		} else {
			house_GetPickupPos(gang_houseid, spos_x, spos_y, spos_z);
		}
	}

	if (spawn_type == SPAWN_TYPE_NONE) {
		new spawnid = GetPlayerSpawnID(playerid);
		spos_x = gSpawns[spawnid][e_sPosX];
		spos_y = gSpawns[spawnid][e_sPosY];
		spos_z = gSpawns[spawnid][e_sPosZ];
		spos_a = gSpawns[spawnid][e_sAngle];
	}

	return 1;
}

stock UpdatePlayerSpawnInfo(playerid)
{
	SaveDeathInfo(playerid);
	SetPlayerSpawnCoords(playerid, 0.0, 0.0, 0.0, 0.0, 0, 0);
	ResetPlayerRandomSpawnID(playerid);

	new
		Float:spawn_pos_x,
		Float:spawn_pos_y,
		Float:spawn_pos_z,
		Float:spawn_pos_a;

	GetPlayerSpawnPos(playerid, spawn_pos_x, spawn_pos_y, spawn_pos_z, spawn_pos_a);
	SetSpawnInfo(playerid, 0, GetPlayerSkin(playerid), spawn_pos_x, spawn_pos_y, spawn_pos_z, spawn_pos_a, 0, 0, 0, 0, 0, 0);
}

/*
	Private functions
*/

static stock GetPlayerSpawnID(playerid)
{
	new
		index,
		interior,
		world,
		Float:pos_x,
		Float:pos_y,
		Float:pos_z;

	index = Enterexit_GetPlayerIndex(playerid);
	interior = GetDeathInterior(playerid);
	world = GetDeathVirtualWorld(playerid);

	if (Enterexit_IsValidInfo(index, interior, world)) {
		Enterexit_GetPos(index, pos_x, pos_y, pos_z);
	} else if (interior == 0 && world == 0) {
		GetDeathPos(playerid, pos_x, pos_y, pos_z);
	}

	if (pos_x == 0.0 && pos_y == 0.0 && pos_z == 0.0) {
		return GetPlayerRandomSpawnID(playerid);
	}

	return GetNearestRandomSpawnID(pos_x, pos_y);
}

static stock GetPlayerRandomSpawnID(playerid)
{
	new id = GetPVarInt(playerid, "random_spawn_id");
	if (id != -1) {
		Log(playerlog, DEBUG, "player_spawn:GetPlayerRandomSpawnID(%d): return stolen spawn id: %d.", playerid, id);
		return id;
	}

	id = random( sizeof(gSpawns) );
	SetPVarInt(playerid, "random_spawn_id", id);

	Log(playerlog, DEBUG, "player_spawn:GetPlayerRandomSpawnID(%d): return random spawn id: %d.", playerid, id);
	return id;
}

static stock GetNearestRandomSpawnID(Float:x, Float:y)
{
	new
		chunk_x,
		chunk_y,
		chunk_pointid;

	GetPointChunkPos(x, y, chunk_x, chunk_y);
	chunk_pointid = random(gChunkPointsCount[chunk_x]{chunk_y});
	return gChunkPoints[chunk_x][chunk_y][chunk_pointid];
}

static stock SaveDeathInfo(playerid)
{
	new
		Float:pos_x,
		Float:pos_y,
		Float:pos_z;

	GetPlayerPos(playerid, pos_x, pos_y, pos_z);
	SetDeathPos(playerid, pos_x, pos_y, pos_z);
	SetDeathInterior(playerid, GetPlayerInterior(playerid));
	SetDeathVirtualWorld(playerid, GetPlayerVirtualWorld(playerid));
	return 1;
}

static stock GetDeathPos(playerid, &Float:x, &Float:y, &Float:z)
{
	x = GetPVarFloat(playerid, "pl_spawn_DeathPosX");
	y = GetPVarFloat(playerid, "pl_spawn_DeathPosY");
	z = GetPVarFloat(playerid, "pl_spawn_DeathPosZ");
}

static stock SetDeathPos(playerid, Float:x, Float:y, Float:z)
{
	SetPVarFloat(playerid, "pl_spawn_DeathPosX", x);
	SetPVarFloat(playerid, "pl_spawn_DeathPosY", y);
	SetPVarFloat(playerid, "pl_spawn_DeathPosZ", z);
}

static stock SetDeathInterior(playerid, interior)
{
	SetPVarInt(playerid, "pl_spawn_DeathInterior", interior);
}

static stock GetDeathInterior(playerid)
{
	return GetPVarInt(playerid, "pl_spawn_DeathInterior");
}

static stock SetDeathVirtualWorld(playerid, world)
{
	SetPVarInt(playerid, "pl_spawn_DeathWorld", world);
}

static stock GetDeathVirtualWorld(playerid)
{
	return GetPVarInt(playerid, "pl_spawn_DeathWorld");
}

/*
	Public functions
*/

stock ResetPlayerRandomSpawnID(playerid)
{
	SetPVarInt(playerid, "random_spawn_id", -1);
}

stock IsPlayerSpawned(playerid) {
	return (GetPVarInt(playerid, "Spawned") == 1 ? 1 : 0);
}

stock SetPlayerSpawned(playerid, isspawned) {
	SetPVarInt(playerid, "Spawned", isspawned);
}

stock GetPlayerSpawnHouseID(playerid) {
	return GetPVarInt(playerid, "SpawnHouseID");
}

stock SetPlayerSpawnHouseID(playerid, houseid) {
	SetPVarInt(playerid, "SpawnHouseID", houseid);
}

stock SetPlayerSpawnCoords(playerid, Float:x, Float:y, Float:z, Float:a, interior, world)
{
	SetPVarFloat(playerid, "Coord_X", x);
	SetPVarFloat(playerid, "Coord_Y", y);
	SetPVarFloat(playerid, "Coord_Z", z);
	SetPVarFloat(playerid, "Coord_A", a);
	SetPVarInt(playerid, "Interior", interior);
	SetPVarInt(playerid, "World", world);
}

stock GetPlayerSpawnCoords(playerid, &Float:x, &Float:y, &Float:z, &Float:a, &interior, &world)
{
	x = GetPVarFloat(playerid, "Coord_X");
	y = GetPVarFloat(playerid, "Coord_Y");
	z = GetPVarFloat(playerid, "Coord_Z");
	a = GetPVarFloat(playerid, "Coord_A");
	interior = GetPVarInt(playerid, "Interior");
	world = GetPVarInt(playerid, "World");
}

stock SetPlayerSpawnType(playerid, SpawnType:type)
{
	gPlayerSpawnType[playerid] = type;
}

stock SpawnType:GetPlayerSpawnType(playerid)
{
	return gPlayerSpawnType[playerid];
}

static stock GetPointChunkPos(Float:x, Float:y, &chunk_x, &chunk_y)
{
	new
		Float:area = float(MAX_AREA_SIZE - MAX_CELL_SIZE),
		Float:size = float(MAX_CELL_SIZE);

	if (x < -area) {
		x = -area + 1.0;
	} else if (x > area) {
		x = area - 1.0;
	}

	if (y < -area) {
		y = -area + 1;
	} else if (y > area) {
		y = area - 1;
	}

	chunk_x = floatround((x + area) / size, floatround_floor);
	chunk_y = floatround((y + area) / size, floatround_floor);
}
